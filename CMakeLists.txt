PROJECT(game)
CMAKE_MINIMUM_REQUIRED(VERSION 3.1)
#SET(CMAKE_CXX_COMPILER "g++")
#SET(CMAKE_BUILD_TYPE "Debug")
#SET(CMAKE_CXX_FLAGS_DEBUG "$ENV{CXXFLAGS} -O0 -Wall -g -ggdb")
#SET(CMAKE_CXX_FLAGS_RELEASE "$ENV{CXXFLAGS} -O3 -Wall")
INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/server/share/)
INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/server/game/)
INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/server/center/)

find_package(Protobuf REQUIRED)

INCLUDE_DIRECTORIES(${PROTOBUF_INCLUDE_DIRS})

FILE(GLOB_RECURSE share_src ${PROJECT_SOURCE_DIR}/server/share/*.cpp)
FILE(GLOB_RECURSE proto_src ${PROJECT_SOURCE_DIR}/server/share/*.cc)
ADD_LIBRARY(share SHARED ${share_src})
ADD_LIBRARY(proto SHARED ${proto_src})
SET_TARGET_PROPERTIES(share PROPERTIES LIBRARY_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/bin/lib/)
SET_TARGET_PROPERTIES(proto PROPERTIES LIBRARY_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/bin/lib/)

#AUX_SOURCE_DIRECTORY(${PROJECT_SOURCE_DIR}/server/game/ game_src)
FILE(MAKE_DIRECTORY ${PROJECT_SOURCE_DIR}/bin/game/)
#AUX_SOURCE_DIRECTORY(${PROJECT_SOURCE_DIR}/server/center/ center_src)
FILE(MAKE_DIRECTORY ${PROJECT_SOURCE_DIR}/bin/center/)

FILE(GLOB_RECURSE game_src ${PROJECT_SOURCE_DIR}/server/game/*.cpp)
FILE(GLOB_RECURSE center_src ${PROJECT_SOURCE_DIR}/server/center/*.cpp)

if(MSVC)

ADD_EXECUTABLE(game ${game_src})
SET_TARGET_PROPERTIES(game PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/bin/game/)
SET_TARGET_PROPERTIES(game PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ${PROJECT_SOURCE_DIR}/bin/game/)
SET_TARGET_PROPERTIES(game PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ${PROJECT_SOURCE_DIR}/bin/game/)
ADD_EXECUTABLE(center ${center_src})
SET_TARGET_PROPERTIES(center PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/bin/center/)
SET_TARGET_PROPERTIES(center PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ${PROJECT_SOURCE_DIR}/bin/center/)
SET_TARGET_PROPERTIES(center PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ${PROJECT_SOURCE_DIR}/bin/center/)

else()

ADD_EXECUTABLE(game.bin ${game_src})
SET_TARGET_PROPERTIES(game.bin PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/bin/game/)
SET_TARGET_PROPERTIES(game.bin PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ${PROJECT_SOURCE_DIR}/bin/game/)
SET_TARGET_PROPERTIES(game.bin PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ${PROJECT_SOURCE_DIR}/bin/game/)
TARGET_LINK_LIBRARIES(game.bin share)
TARGET_LINK_LIBRARIES(game.bin proto)
TARGET_LINK_LIBRARIES(game.bin ${PROTOBUF_LIBRARIES})

ADD_EXECUTABLE(center.bin ${center_src})
SET_TARGET_PROPERTIES(center.bin PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR}/bin/center/)
SET_TARGET_PROPERTIES(center.bin PROPERTIES RUNTIME_OUTPUT_DIRECTORY_DEBUG ${PROJECT_SOURCE_DIR}/bin/center/)
SET_TARGET_PROPERTIES(center.bin PROPERTIES RUNTIME_OUTPUT_DIRECTORY_RELEASE ${PROJECT_SOURCE_DIR}/bin/center/)
TARGET_LINK_LIBRARIES(center.bin share)
TARGET_LINK_LIBRARIES(center.bin proto)
TARGET_LINK_LIBRARIES(center.bin ${PROTOBUF_LIBRARIES})

endif (MSVC)


